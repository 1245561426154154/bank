// File: app/page.tsx (Next.js App Router)

import { useState } from 'react';
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { Button } from "@/components/ui/button";
import { Card, CardContent } from "@/components/ui/card";

export default function Home() {
  const [luaCode, setLuaCode] = useState("");
  const [resultLink, setResultLink] = useState("");
  const [loading, setLoading] = useState(false);

  async function uploadCode() {
    setLoading(true);
    const res = await fetch("/api/upload", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ code: luaCode })
    });
    const data = await res.json();
    if (data?.id) {
      setResultLink(`${window.location.origin}/api/script/${data.id}`);
    }
    setLoading(false);
  }

  return (
    <main className="max-w-xl mx-auto mt-10">
      <Card className="p-4">
        <CardContent className="space-y-4">
          <h1 className="text-2xl font-bold">ðŸ§  LuaU Script Submitter</h1>
          <label className="text-sm font-medium">Paste your Roblox LuaU code:</label>
          <Textarea
            placeholder="-- Paste Roblox LuaU script here"
            rows={12}
            value={luaCode}
            onChange={(e) => setLuaCode(e.target.value)}
          />
          <Button onClick={uploadCode} disabled={loading}>
            {loading ? "Submitting..." : "Submit"}
          </Button>
          {resultLink && (
            <div className="mt-4 space-y-1">
              <label className="text-sm font-medium text-green-600">Link for Roblox Client:</label>
              <Input value={resultLink} readOnly className="text-sm" />
            </div>
          )}
        </CardContent>
      </Card>
    </main>
  );
}
